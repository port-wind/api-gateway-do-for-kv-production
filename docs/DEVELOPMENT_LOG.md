# å¼€å‘æ—¥å¿—

## 2025-10-02 - çµæ´»ç¼“å­˜é”®ç­–ç•¥åŠŸèƒ½å¼€å‘å¯åŠ¨

### èƒŒæ™¯

å½“å‰ç¼“å­˜ç³»ç»Ÿä½¿ç”¨å›ºå®šçš„ç¼“å­˜é”®ç”Ÿæˆç­–ç•¥ï¼Œæ— æ³•æ»¡è¶³ä»¥ä¸‹ä¸šåŠ¡éœ€æ±‚ï¼š

1. **ç”¨æˆ·éš”ç¦»**ï¼šä¸åŒç”¨æˆ·è®¿é—®åŒä¸€è·¯å¾„ï¼ˆå¦‚ `/biz-client/biz/user/self`ï¼‰éœ€è¦è¿”å›ä¸åŒå†…å®¹
2. **POST è¯·æ±‚ç¼“å­˜**ï¼šéœ€è¦æ ¹æ®è¯·æ±‚å‚æ•°ç¼“å­˜ POST è¯·æ±‚ï¼ˆå¦‚ `/biz-client/biz/issueReplayVideo/list`ï¼‰
3. **çµæ´»é…ç½®**ï¼šæ¯ä¸ªè·¯å¾„éœ€è¦ç‹¬ç«‹é…ç½®ç¼“å­˜é”®ç”Ÿæˆç­–ç•¥

### è§£å†³æ–¹æ¡ˆ

å¼•å…¥**å¯é…ç½®çš„ç¼“å­˜é”®ç­–ç•¥ç³»ç»Ÿ**ï¼Œæ”¯æŒ 4 ç§ç­–ç•¥ï¼š
- `path-only`: ä»…æ ¹æ®è·¯å¾„ç¼“å­˜
- `path-params`: è·¯å¾„ + è¯·æ±‚å‚æ•°
- `path-headers`: è·¯å¾„ + æŒ‡å®š headers
- `path-params-headers`: è·¯å¾„ + å‚æ•° + headers

### å¼€å‘è®¡åˆ’

**åˆ†æ”¯**: `feature/flexible-cache-key-strategy`  
**é¢„è®¡å·¥æœŸ**: 2-3 å‘¨  
**åˆ† 5 ä¸ªé˜¶æ®µ**ï¼š
1. Phase 1: åç«¯åŸºç¡€æ¶æ„ï¼ˆ2-3å¤©ï¼‰
2. Phase 2: åç«¯ API å±‚ï¼ˆ1-2å¤©ï¼‰
3. Phase 3: å‰ç«¯åŸºç¡€ç»„ä»¶ï¼ˆ2-3å¤©ï¼‰
4. Phase 4: å‰ç«¯ç•Œé¢é›†æˆï¼ˆ2-3å¤©ï¼‰
5. Phase 5: æµ‹è¯•ä¸ä¼˜åŒ–ï¼ˆ2-3å¤©ï¼‰

### ç›¸å…³æ–‡æ¡£

- ğŸ“„ [åŠŸèƒ½è®¾è®¡æ–‡æ¡£](./flexible-cache-key-strategy.md) - å®Œæ•´çš„æŠ€æœ¯è®¾è®¡å’Œå®æ–½æ–¹æ¡ˆ
- ğŸ”€ å¼€å‘åˆ†æ”¯: `feature/flexible-cache-key-strategy`

### å˜æ›´æ–‡ä»¶é¢„è§ˆ

**åç«¯**ï¼š
- `apps/api/src/types/config.ts` - æ–°å¢ç±»å‹å®šä¹‰
- `apps/api/src/lib/cache-manager.ts` - é‡æ„ç¼“å­˜é”®ç”Ÿæˆé€»è¾‘
- `apps/api/src/middleware/cache.ts` - æ›´æ–°ç¼“å­˜ä¸­é—´ä»¶
- `apps/api/src/routes/admin/paths.ts` - æ–°å¢ API ç«¯ç‚¹

**å‰ç«¯**ï¼š
- `apps/web/src/types/api.ts` - åŒæ­¥ç±»å‹å®šä¹‰
- `apps/web/src/components/ui/multi-input.tsx` - æ–°ç»„ä»¶
- `apps/web/src/features/paths/components/cache-entries-table.tsx` - æ–°ç»„ä»¶
- `apps/web/src/features/paths/components/unified-path-table.tsx` - æ·»åŠ æ–°åˆ—
- `apps/web/src/features/paths/components/path-config-dialog.tsx` - æ·»åŠ ç­–ç•¥é€‰æ‹©

### å‘åå…¼å®¹æ€§

âœ… **å®Œå…¨å‘åå…¼å®¹**
- é»˜è®¤ç­–ç•¥ä¸º `path-params`ï¼Œä¿æŒç°æœ‰è¡Œä¸º
- æœªé…ç½®ç­–ç•¥çš„è·¯å¾„è‡ªåŠ¨ä½¿ç”¨é»˜è®¤ç­–ç•¥
- æ—§çš„ç¼“å­˜é”®ç»§ç»­æœ‰æ•ˆ

### é£é™©ä¸ç¼“è§£

| é£é™© | å½±å“ | ç¼“è§£æªæ–½ |
|-----|------|---------|
| ç¼“å­˜é”®ç”Ÿæˆæ€§èƒ½ä¸‹é™ | ä¸­ | æ€§èƒ½æµ‹è¯•ç¡®ä¿ < 5msï¼›ä¼˜åŒ–ç®—æ³• |
| ç¼“å­˜æ¡ç›®æŸ¥è¯¢æ…¢ | ä¸­ | é™åˆ¶è¿”å›æ•°é‡ï¼›æ·»åŠ åˆ†é¡µ |
| é…ç½®å¤æ‚åº¦å¢åŠ  | ä½ | æä¾›æ¸…æ™°çš„ UI å’Œæ–‡æ¡£ |
| å‘åå…¼å®¹æ€§é—®é¢˜ | é«˜ | å……åˆ†æµ‹è¯•ï¼›æä¾›å›æ»šæ–¹æ¡ˆ |

### å›æ»šæ–¹æ¡ˆ

å¦‚å‡ºç°ä¸¥é‡é—®é¢˜ï¼Œå¯é€šè¿‡ä»¥ä¸‹æ–¹å¼å¿«é€Ÿå›æ»šï¼š

```bash
# åˆ‡æ¢å›ä¸»åˆ†æ”¯
git checkout main

# é‡æ–°éƒ¨ç½²
npm run deploy
```

---

## å¼€å‘è¿›åº¦

### å½“å‰çŠ¶æ€ï¼šğŸš§ å‡†å¤‡é˜¶æ®µ

- [x] åˆ›å»ºå¼€å‘åˆ†æ”¯ `feature/flexible-cache-key-strategy`
- [x] ç¼–å†™å®Œæ•´çš„åŠŸèƒ½è®¾è®¡æ–‡æ¡£
- [x] åˆ¶å®šè¯¦ç»†çš„å®æ–½è®¡åˆ’
- [ ] Phase 1 å¼€å‘...

### ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. å¼€å§‹ Phase 1 å¼€å‘ï¼šä¿®æ”¹åç«¯ç±»å‹å®šä¹‰
2. å®ç°æ–°çš„ç¼“å­˜é”®ç”Ÿæˆé€»è¾‘
3. ç¼–å†™å•å…ƒæµ‹è¯•

---

## å›¢é˜Ÿæ²Ÿé€š

### éœ€è¦è®¨è®ºçš„é—®é¢˜

1. â“ ç¼“å­˜æ¡ç›®åˆ—è¡¨æ˜¯å¦éœ€è¦åˆ†é¡µï¼Ÿï¼ˆå¦‚æœæŸä¸ªè·¯å¾„æœ‰æ•°åƒä¸ªç¼“å­˜æ¡ç›®ï¼‰
2. â“ æ˜¯å¦éœ€è¦ä¸ºç¼“å­˜æ¡ç›®æ·»åŠ "è®¿é—®æ¬¡æ•°"ç»Ÿè®¡ï¼Ÿ
3. â“ Header åç§°æ˜¯å¦åŒºåˆ†å¤§å°å†™ï¼Ÿï¼ˆå»ºè®®ç»Ÿä¸€å°å†™ï¼‰

### å†³ç­–è®°å½•

| æ—¥æœŸ | å†³ç­– | åŸå›  |
|-----|------|------|
| 2025-10-02 | Header åç§°ç»Ÿä¸€è½¬å°å†™å¤„ç† | HTTP header æœ¬èº«ä¸åŒºåˆ†å¤§å°å†™ï¼Œç»Ÿä¸€å¤„ç†é¿å…æ··æ·† |
| 2025-10-02 | é»˜è®¤ç­–ç•¥ä¸º `path-params` | ä¸ç°æœ‰è¡Œä¸ºä¸€è‡´ï¼Œç¡®ä¿å‘åå…¼å®¹ |

---

## å‚è€ƒèµ„æ–™

- [RFC: Flexible Cache Key Strategy](./flexible-cache-key-strategy.md)
- [ç¼“å­˜ç³»ç»ŸæŠ€æœ¯æ–¹æ¡ˆ](../APIä»£ç†ç¼“å­˜ä¼˜åŒ–æŠ€æœ¯æ–¹æ¡ˆ.md)
- [API å‚è€ƒæ–‡æ¡£](../API_REFERENCE.md)

